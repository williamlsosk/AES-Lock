<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lock AES</title>
<style>
:root{
  --bg1:#0f172a;
  --bg2:#020617;
  --stroke:#1e293b;
  --muted:#94a3b8;
  --text:#e5e7eb;
  --blue:#2563eb;
  --tg:#2AABEE;
  --ok:#22c55e;
  --err:#ef4444;
}
*{box-sizing:border-box;margin:0;padding:0}
body{
  font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
  background:radial-gradient(circle at top,var(--bg1),var(--bg2));
  color:var(--text);
  min-height:100vh;
  overflow:hidden;
}
.app{max-width:420px;margin:0 auto;padding:20px}
h1{margin:0 0 14px;text-align:center;font-weight:800;letter-spacing:.2px}
.tabs{display:flex;gap:10px;margin:10px 0 12px}
.tabs button{
  flex:1;
  padding:12px;
  border-radius:14px;
  border:none;
  background:#1e293b;
  color:var(--muted);
  font-weight:800;
  cursor:pointer;
  transition:transform .08s ease,background .15s ease;
}
.tabs button:active{transform:scale(.99)}
.tabs button.active{background:var(--blue);color:#fff}
textarea,input{
  width:100%;
  background:rgba(2,6,23,.75);
  color:#fff;
  border:1px solid var(--stroke);
  border-radius:14px;
  padding:14px;
  margin-bottom:12px;
  font-size:15px;
  outline:none;
  resize:none;
}
textarea{height:120px}
input::placeholder,textarea::placeholder{color:#64748b}
.main{
  width:100%;
  padding:14px;
  border-radius:16px;
  border:none;
  background:var(--blue);
  color:#fff;
  font-weight:900;
  font-size:16px;
  cursor:pointer;
  transition:transform .08s ease,filter .15s ease;
}
.main:active{transform:scale(.99)}
.main:hover{filter:brightness(1.05)}
.output{
  border:1px solid var(--stroke);
  border-radius:14px;
  padding:14px;
  margin-top:10px;
  font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono",monospace;
  word-break:break-all;
  background:rgba(2,6,23,.75);
  height:120px;
  overflow-y:auto;
  color:#fff;
}
.output::-webkit-scrollbar{width:6px}
.output::-webkit-scrollbar-track{background:rgba(30,41,59,.5);border-radius:10px}
.output::-webkit-scrollbar-thumb{background:var(--muted);border-radius:10px}
.output::-webkit-scrollbar-thumb:hover{background:#cbd5e1}
.status{margin-top:10px;font-weight:800;font-size:14px}
.status.ok{color:var(--ok)}
.status.err{color:var(--err)}
.row{display:flex;gap:10px;margin-top:10px}
.ghost{
  flex:1;
  padding:12px;
  border-radius:14px;
  border:1px solid rgba(148,163,184,.25);
  background:rgba(148,163,184,.08);
  color:#cbd5e1;
  font-weight:800;
  cursor:pointer;
}
.ghost:active{transform:scale(.99)}
.tg-fab{
  position:fixed;
  right:22px;
  bottom:22px;
  width:58px;
  height:58px;
  border-radius:50%;
  background:var(--tg);
  border:none;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:0;
  box-shadow:0 10px 25px rgba(0,0,0,.45);
  cursor:pointer;
  z-index:9999;
  transition:transform .15s ease,box-shadow .15s ease;
}
.tg-fab:hover{transform:scale(1.05);box-shadow:0 12px 30px rgba(0,0,0,.55)}
.tg-fab:active{transform:scale(.95)}
.tg-fab svg{width:30px;height:30px;display:block;overflow:visible;fill:#fff}
.tg-panel{
  position:fixed;
  right:18px;
  bottom:92px;
  width:min(340px,calc(100vw - 36px));
  max-height:calc(100vh - 150px);
  background:rgba(2,6,23,.95);
  border:1px solid rgba(30,41,59,.9);
  border-radius:18px;
  padding:16px;
  box-shadow:0 20px 60px rgba(0,0,0,.7);
  display:none;
  z-index:9998;
  backdrop-filter:blur(12px);
  overflow-y:auto;
}
.tg-panel::-webkit-scrollbar{width:6px}
.tg-panel::-webkit-scrollbar-track{background:rgba(30,41,59,.5);border-radius:10px}
.tg-panel::-webkit-scrollbar-thumb{background:var(--muted);border-radius:10px}
.tg-panel::-webkit-scrollbar-thumb:hover{background:#cbd5e1}
.tg-panel.open{display:block;animation:slideUp .2s ease}
@keyframes slideUp{
  from{opacity:0;transform:translateY(10px)}
  to{opacity:1;transform:translateY(0)}
}
.tg-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px;padding-bottom:10px;border-bottom:1px solid rgba(148,163,184,.12)}
.tg-head h3{margin:0;font-size:17px;letter-spacing:.3px;font-weight:900}
.tg-close{
  border:none;
  background:rgba(148,163,184,.08);
  color:#cbd5e1;
  font-size:20px;
  line-height:1;
  cursor:pointer;
  padding:6px 10px;
  border-radius:8px;
  transition:background .15s ease;
}
.tg-close:hover{background:rgba(148,163,184,.18)}
.tg-close:active{transform:scale(.95)}
.tg-item{
  background:linear-gradient(135deg,rgba(15,23,42,.9),rgba(30,41,59,.7));
  border:1px solid rgba(148,163,184,.15);
  border-radius:12px;
  padding:14px;
  margin-bottom:8px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  cursor:pointer;
  transition:all .15s ease;
}
.tg-item:hover{
  background:linear-gradient(135deg,rgba(30,41,59,.9),rgba(51,65,85,.8));
  border-color:rgba(148,163,184,.3);
  transform:translateX(-2px);
}
.tg-item:active{transform:scale(.98)}
.tg-left{display:flex;flex-direction:column;gap:3px}
.tg-left span{font-size:14.5px;font-weight:850;color:#e5e7eb}
.tg-left small{color:var(--muted);font-size:12px}
.tg-arrow{opacity:.8;font-size:18px;margin-left:12px;transition:transform .15s ease}
.tg-item:hover .tg-arrow{transform:translate(2px,-2px);opacity:1}
</style>
</head>
<body>
<div class="app">
  <h1>üîê Lock AES</h1>
  <div class="tabs">
    <button id="tEnc" class="active" type="button">Encrypt</button>
    <button id="tDec" type="button">Decrypt</button>
  </div>
  <div id="encView">
    <textarea id="encText" placeholder="Texto"></textarea>
    <input id="encPass" type="password" placeholder="Clave"/>
    <button id="encBtn" class="main" type="button">Encrypt</button>
    <div class="output" id="encOut"></div>
    <div class="status" id="encStatus"></div>
    <div class="row">
      <button class="ghost" id="copyEnc" type="button">Copiar</button>
      <button class="ghost" id="clearEnc" type="button">Limpiar</button>
    </div>
  </div>
  <div id="decView" style="display:none">
    <textarea id="decPack" placeholder="LOCK1.i=200000...."></textarea>
    <input id="decPass" type="password" placeholder="Clave"/>
    <button id="decBtn" class="main" type="button">Decrypt</button>
    <div class="output" id="decOut"></div>
    <div class="status" id="decStatus"></div>
    <div class="row">
      <button class="ghost" id="copyDec" type="button">Copiar</button>
      <button class="ghost" id="clearDec" type="button">Limpiar</button>
    </div>
  </div>
</div>

<button class="tg-fab" id="tgFab" type="button" aria-label="Telegram">
  <svg viewBox="0 0 24 24" aria-hidden="true">
    <path d="M9.04 15.47 8.7 20.1c.49 0 .7-.21.96-.46l2.3-2.2 4.77 3.49c.88.49 1.5.23 1.73-.81l3.14-14.72v-.01c.3-1.38-.5-1.92-1.36-1.6L2.4 9.14c-1.35.53-1.33 1.29-.23 1.63l4.42 1.38L17.1 6.5c.49-.33.94-.15.57.18L9.2 13.27c-.3.24-.29.56-.06.7l6.88 5.18"/>
  </svg>
</button>

<div class="tg-panel" id="tgPanel" aria-hidden="true">
  <div class="tg-head">
    <h3>Telegram</h3>
    <button class="tg-close" id="tgClose" type="button" aria-label="Cerrar">√ó</button>
  </div>
  <div class="tg-item" data-tg="https://t.me/forzagrupo">
    <div class="tg-left"><span>Forza</span><small>@forzagrupo</small></div><div class="tg-arrow">‚Üó</div>
  </div>
  <div class="tg-item" data-tg="https://t.me/confiesatehoy1">
    <div class="tg-left"><span>Confiesate</span><small>@confiesatehoy1</small></div><div class="tg-arrow">‚Üó</div>
  </div>
  <div class="tg-item" data-tg="https://t.me/+ypuHtkyJG7tmZWQx">
    <div class="tg-left"><span>APK N3XU5</span><small>Invite link</small></div><div class="tg-arrow">‚Üó</div>
  </div>
  <div class="tg-item" data-tg="https://t.me/+SprIq73R1J1kZDJh">
    <div class="tg-left"><span>ALL FOR ONE</span><small>Invite link</small></div><div class="tg-arrow">‚Üó</div>
  </div>
  <div class="tg-item" data-tg="https://t.me/binneerz2">
    <div class="tg-left"><span>Binneerz</span><small>@binneerz2</small></div><div class="tg-arrow">‚Üó</div>
  </div>
  <div class="tg-item" data-tg="https://t.me/+0qw3nXYO7NA3NGNh">
    <div class="tg-left"><span>TIO-P3L1CULAS</span><small>Invite link</small></div><div class="tg-arrow">‚Üó</div>
  </div>
</div>

<script>
  function contieneLinksProhibidos(texto) {const permitidos = [
  /https?:\/\/(www\.)?canva\.com\/.+/i,

  // Spotify (m√°s completo)
  /https?:\/\/(open|www)\.spotify\.com\/.+/i,
  /https?:\/\/spotify\.com\/.+/i,
  /https?:\/\/spotify\.link\/.+/i,
  /https?:\/\/spoti\.fi\/.+/i
];

  const detectar = /https?:\/\/\S+/i;

  if (!detectar.test(texto)) return false;

  for (const regla of permitidos) {
    if (regla.test(texto)) return false;
  }

  return true;
}
const CONFIG = {
  VERSION: "LOCK1",
  PBKDF2_ITERS: 200000,
  KEY_BITS: 256,
  SALT_SIZE: 16,
  IV_SIZE: 12
};

class Base64Utils {
  static toUrlSafe(bytes) {
    const bin = String.fromCharCode(...bytes);
    return btoa(bin).replace(/\+/g, "-").replace(/\//g, "_").replace(/=+$/, "");
  }

  static fromUrlSafe(b64url) {
    const b64 = b64url.replace(/-/g, "+").replace(/_/g, "/");
    const pad = "=".repeat((4 - (b64.length % 4)) % 4);
    const bin = atob(b64 + pad);
    return new Uint8Array([...bin].map(c => c.charCodeAt(0)));
  }
}

class CryptoService {
  static #encoder = new TextEncoder();
  static #decoder = new TextDecoder();

  static #generateRandom(size) {
    const buffer = new Uint8Array(size);
    crypto.getRandomValues(buffer);
    return buffer;
  }

  static async #deriveKey(password, salt) {
    const baseKey = await crypto.subtle.importKey(
      "raw",
      this.#encoder.encode(password),
      { name: "PBKDF2" },
      false,
      ["deriveKey"]
    );

    return crypto.subtle.deriveKey(
      {
        name: "PBKDF2",
        salt,
        iterations: CONFIG.PBKDF2_ITERS,
        hash: "SHA-256"
      },
      baseKey,
      { name: "AES-GCM", length: CONFIG.KEY_BITS },
      false,
      ["encrypt", "decrypt"]
    );
  }

  static async encrypt(plaintext, password) {
    const salt = this.#generateRandom(CONFIG.SALT_SIZE);
    const iv = this.#generateRandom(CONFIG.IV_SIZE);
    const key = await this.#deriveKey(password, salt);
    
    const ciphertext = await crypto.subtle.encrypt(
      { name: "AES-GCM", iv },
      key,
      this.#encoder.encode(plaintext)
    );

    return [
      CONFIG.VERSION,
      `i=${CONFIG.PBKDF2_ITERS}`,
      Base64Utils.toUrlSafe(salt),
      Base64Utils.toUrlSafe(iv),
      Base64Utils.toUrlSafe(new Uint8Array(ciphertext))
    ].join(".");
  }

  static async decrypt(package_, password) {
    const parts = package_.trim().split(".");
    if (parts.length < 5) throw new Error("Paquete incompleto");

    const [version, iPart, saltB64, ivB64, ctB64] = parts;
    
    if (version !== CONFIG.VERSION) throw new Error("Versi√≥n inv√°lida");
    if (!iPart.startsWith("i=")) throw new Error("Formato de iteraciones inv√°lido");

    const salt = Base64Utils.fromUrlSafe(saltB64);
    const iv = Base64Utils.fromUrlSafe(ivB64);
    const ciphertext = Base64Utils.fromUrlSafe(ctB64);
    
    const key = await this.#deriveKey(password, salt);
    
    const plaintext = await crypto.subtle.decrypt(
      { name: "AES-GCM", iv },
      key,
      ciphertext
    );

    return this.#decoder.decode(plaintext);
  }
}

class UIController {
  #elements;

  constructor(elements) {
    this.#elements = elements;
    this.#attachEventListeners();
  }

  #attachEventListeners() {
    const { tEnc, tDec, encBtn, decBtn, copyEnc, copyDec, clearEnc, clearDec } = this.#elements;

    tEnc.addEventListener("click", () => this.#switchTab("enc"));
    tDec.addEventListener("click", () => this.#switchTab("dec"));
    encBtn.addEventListener("click", () => this.#handleEncrypt());
    decBtn.addEventListener("click", () => this.#handleDecrypt());
    copyEnc.addEventListener("click", () => this.#handleCopy("enc"));
    copyDec.addEventListener("click", () => this.#handleCopy("dec"));
    clearEnc.addEventListener("click", () => this.#handleClear("enc"));
    clearDec.addEventListener("click", () => this.#handleClear("dec"));
  }

 #switchTab(tab) {
  const isEnc = tab === "enc";
  this.#elements.tEnc.classList.toggle("active", isEnc);
  this.#elements.tDec.classList.toggle("active", !isEnc);
  this.#elements.encView.style.display = isEnc ? "block" : "none";
  this.#elements.decView.style.display = isEnc ? "none" : "block";
}
async #handleEncrypt() {
  const { encText, encPass, encOut } = this.#elements;
  this.#clearStatus("enc");

  const text = encText.value?.trim();
  const password = encPass.value;

  if (!text) return this.#setStatus("enc", "Escribe un texto", "err");
  if (!password) return this.#setStatus("enc", "Escribe una clave", "err");
// ‚úÖ BLOQUEO SPAM
if (contieneLinksProhibidos(text)) {
  return this.#setStatus("enc", "‚ùå No spam", "err");
}
  try {
    encOut.textContent = await CryptoService.encrypt(text, password);
    this.#setStatus("enc", "OK", "ok");
  } catch (e) {
    this.#setStatus("enc", e?.message ? `Error: ${e.message}` : "Error", "err");
  }
}
async #handleDecrypt(){
  const { decPack, decPass, decOut } = this.#elements;
  this.#clearStatus("dec");

  const package_ = decPack.value?.trim();
  const password = decPass.value;

  if (!package_) return this.#setStatus("dec", "Pega el paquete cifrado", "err");
  if (!password) return this.#setStatus("dec", "Escribe la clave", "err");

  try {
    decOut.textContent = await CryptoService.decrypt(package_, password);
    this.#setStatus("dec", "OK", "ok");
  } catch {
    this.#setStatus("dec", "Clave o paquete inv√°lido", "err");
  }
}
  async #handleCopy(tab) {
    const output = this.#elements[`${tab}Out`];
    const text = output.textContent.trim();
    if (!text) return;

    try {
      await navigator.clipboard.writeText(text);
      this.#setStatus(tab, "Copiado", "ok");
    } catch {
      this.#setStatus(tab, "Error al copiar", "err");
    }
  }

  #handleClear(tab) {
    const fields = tab === "enc" 
      ? ["encText", "encPass", "encOut"] 
      : ["decPack", "decPass", "decOut"];
    
    fields.forEach(field => {
      const el = this.#elements[field];
      if (el.tagName === "TEXTAREA" || el.tagName === "INPUT") {
        el.value = "";
      } else {
        el.textContent = "";
      }
    });
    
    this.#clearStatus(tab);
  }

  #setStatus(tab, message, type) {
    const status = this.#elements[`${tab}Status`];
    status.textContent = message;
    status.className = `status ${type}`;
  }

  #clearStatus(tab) {
    const status = this.#elements[`${tab}Status`];
    status.textContent = "";
    status.className = "status";
    this.#elements[`${tab}Out`].textContent = "";
  }
}

class TelegramPanel {
  #elements;

  constructor(elements) {
    this.#elements = elements;
    this.#attachEventListeners();
  }

  #attachEventListeners() {
    const { fab, panel, close, items } = this.#elements;
    
    fab.addEventListener("click", () => this.#toggle());
    close.addEventListener("click", () => this.#close());
    
    items.forEach(item => {
      item.addEventListener("click", () => {
        const url = item.dataset.tg;
        if (url) this.#openTelegram(url);
      });
    });

    document.addEventListener("click", e => {
      if (!panel.classList.contains("open")) return;
      if (panel.contains(e.target) || fab.contains(e.target)) return;
      this.#close();
    });
  }

  #toggle() {
    const isOpen = this.#elements.panel.classList.toggle("open");
    this.#elements.panel.setAttribute("aria-hidden", !isOpen);
  }

  #close() {
    this.#elements.panel.classList.remove("open");
    this.#elements.panel.setAttribute("aria-hidden", "true");
  }

  #buildDeepLink(httpsUrl) {
    try {
      const url = new URL(httpsUrl);
      const path = url.pathname.replace(/^\/+/, "");
      if (!path) return null;

      if (path.startsWith("+")) {
        return `tg://join?invite=${encodeURIComponent(path.slice(1))}`;
      }

      const username = path.split("/")[0];
      return `tg://resolve?domain=${encodeURIComponent(username)}`;
    } catch {
      return null;
    }
  }

  #tryAppScheme(schemeUrl) {
    const iframe = document.createElement("iframe");
    iframe.style.display = "none";
    iframe.src = schemeUrl;
    document.body.appendChild(iframe);
    setTimeout(() => {
      try { document.body.removeChild(iframe); } catch {}
    }, 1200);
  }

  #openTelegram(httpsUrl) {
    const deepLink = this.#buildDeepLink(httpsUrl);
    if (deepLink) {
      try { this.#tryAppScheme(deepLink); } catch {}
    }
    setTimeout(() => { window.location.href = httpsUrl; }, 450);
  }
}

(() => {
  const uiElements = {
    tEnc: document.getElementById("tEnc"),
    tDec: document.getElementById("tDec"),
    encView: document.getElementById("encView"),
    decView: document.getElementById("decView"),
    encText: document.getElementById("encText"),
    encPass: document.getElementById("encPass"),
    encOut: document.getElementById("encOut"),
    encStatus: document.getElementById("encStatus"),
    encBtn: document.getElementById("encBtn"),
    copyEnc: document.getElementById("copyEnc"),
    clearEnc: document.getElementById("clearEnc"),
    decPack: document.getElementById("decPack"),
    decPass: document.getElementById("decPass"),
    decOut: document.getElementById("decOut"),
    decStatus: document.getElementById("decStatus"),
    decBtn: document.getElementById("decBtn"),
    copyDec: document.getElementById("copyDec"),
    clearDec: document.getElementById("clearDec")
  };

  const tgElements = {
    fab: document.getElementById("tgFab"),
    panel: document.getElementById("tgPanel"),
    close: document.getElementById("tgClose"),
    items: document.querySelectorAll(".tg-item")
  };

  new UIController(uiElements);
  new TelegramPanel(tgElements);
})();</script>
</body>
</html>
